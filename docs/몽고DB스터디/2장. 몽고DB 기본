2장. 몽고DB 기본

몽고DB 기본 개념
 > 기본단위는 도큐먼트
 > 컬렉션은 동적 스키마가 없는 테이블
 > 몽고DB 인스턴스는 여러 개의 독립적인 데이터베이스 호스팅
 > 모든 도큐먼트는 고유의 특수키가 존재
 > 몽고셀은 인스턴스 관리/데이터 조작 지원/자바스크립트 해석가임

2.1 도큐먼트
 > 키와 연결된 값의 집합 {"greeting" : "Hello, world!"}
 > 키는 UTF-8문자 가능(몇가지 제외)
   - 제외사항 : \0, $
 > 데이터형과 대소문자 구별(즉 다른 도큐먼트임)
   - {"count" : 5} vs {"count" : "5"}
   - {"count" : 5} vs {"Count" : 5 }
 > 키는 중복X
 
2.2 컬렉션
 > 도큐먼트의 모음(테이블과 유사)
 > 동적스키마를 가짐(모두 다른 구조의 도큐먼트를 가질 수 있음)
   - {"greeting" : "Hello"} with {"signoff" : "Good"}
 > 다른 구조의 도큐먼트가 가능한데 N개 컬렉션이 필요한가?
   - 관리의 번거로움 방지
   - 목적에 맞는 데이터를 뽑을 때 컬렉션을 나누는 것이 찾기 빠름
   - 같은 종료의 데이터를 모으면 지역성이 좋아져서 탐색시간 짧아짐
   - 인덱스를 만들려면 특정 구조를 가져야 함
 > 컬렉션명은 UTF-8이면 가능(단 몇 가지 제약 조건 존재)
   - 제약조건 : 빈문자열, \0, system.(예약어임), $
 > 서브컬렉션으로 체계화하면 좋음
   - 예시 : blog.posts, blog.authors
   - 큰 파일 저장시 유용
   - 드라이버 특정 접근시 편리한 문법 제공(db.blog.posts)
   
2.3 데이터베이스
 > 데이터베이스에 컬렉션을 그룹핑함
 > 단일 인스턴스로 여러 DB 호스팅 가능(각각 독립된 db 운영)
 > 데이터베이스 이름도 UTF-8문자이면 가능(단 몇가지 제약조건 존재)
   - 제약조건 : 빈문자열, 일부 특수문자들, \0
   - 대소문자 구별함
   - 최대 64바이트임
 > 예약된 데이터베이스명도 존재함
   - admin, local, config

2.4 몽고DB 시작
 > mongod로 시작(포트 27017)
   - 시작시 별도 디렉토리를 파리미터로 지정 가능

2.5 몽고DB 셀 소개
 > 셀은 관리 기능, 점검, 간단한 기능 시험에 유용한 도국
 > mongo로 시작
 > 자바스크립트 해석기(수식, 라이브러리, 함수 정의도 가능)
 > 현 db 노출 : db
 > db선택 : use db명
 > 컬렉션접근 : db.컬렉션명
 > CRUD
   - 생성 : db.컬렉션명.insertOne(인서트 도규먼트 혹은 정의된 변수)
   - 읽기 : db.컬렉션명.findOne() 혹은 find() - 조건도 파라미터로 받을 수 있음
   - 갱신 : db.컬렉션명.updateOne(대상 도큐먼트, 갱신 작업 설명 도큐먼트)
           > $set 갱신 연산자 이용
   - 삭제 : db.컬렉션명.deleteOne(도큐먼트 조건)

2.6 데이터형
 > 기본 데이터형
   - null, 불리언, 숫자(64비트 부동소수점, 정수형도 가능), 문자열, 날짜(new Data()), 정규식, 배열, 내장 도큐먼트, 객체ID(분산 샤딩 시 고유 식별자 역할), 이진데이터, 코드

2.7 몽고DB셸 사용
 > 다른 장비 DB에 연결 가능 - $mongo some-host:30000/myDB
 > 자바스크립트 파일 수행 가능 - mongo script1.js script2.js
   - 다른 장비 DB에 자바스크립트 수행 가능
   - 자바스크립트 내에서 use DB명 -> db.getSisterDB("DB명")
   - 자바스크립트 내에서 show dbs -> db.getMongo().getDBs()
   - 자바스크립트 내에서 show collections -> db.getCollectionNames()
 > .mongorc.js
   - 자주 로드되는 스크립트 내용을 해당 js에 추가하면 로그인할 때마다 자동으로 로드됨
   - .dropDatabase, deleteIndexes를 사용해제시 유용함.
   - 프롬프트 커스터마이징할 때 유용함
 > 에디터 설명 가능 EDITOR="/usr/bin/emacs"
