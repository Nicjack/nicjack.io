5장 카프카 실전 프로젝트(5.1.5 ~ 5.4)
===================
1) 상용 인프라 아키텍처
   * #### 이벤트 파이프라인 인프라 아키텍처
     * #### L4 로드밸런서 > 프로듀서(스케일 아웃) > 카프카 클러스터(파티션 증가) > 컨슈머(스케일 아웃) Or 커넥트(태스크 증가)
       * #### 스케일 아웃/파티션 증가/태스크 증가로 병렬 처리하여 적재 지연을 줄일 수 있다.
   * #### 서버 지표 수집 파이프라인 생성과 카프카 스트림즈 활용
     * #### 서비 지표(CPU/메모리/네트워크/디스크 지표)의 정보를 수집 모니터링 필요
       * #### 메트릭비트(metricbeat)를 활용하여 서버 지표를 수집할 수 있다.(카프카로 전송 가능)
         * #### 다양한 모듈을 사용할 수 있으며 그 중 서버 지표를 수집을 위해서 시스템 모듈을 사용하면 된다.
         * #### 간격은 설정하면 되는 데 보통 10초 간격으로 셋팅하여 과도한 데이터가 수집되지 않도록 한다.
     * #### 파이프라인 정책 검토 필요
       * #### 일부 데이터 유실 또는 중복 허용할지?
       * #### 안정적으로 끊임없는 적재를 해야할지?
     * #### 카프카 스트림즈
       * #### 서버 지표 데이터를 분기하고 필터링이 필요할 경우는 카프카 스트림즈가 최적임
         * #### 요구사항에 맞는 토폴로지를 그리고 각 프로세서에 맞는 DSL메소드를 찾아서 적용하거나 DSL이 불가능한 경우 프로세서 API사용한다.
           * #### CPU와 메모리 토픽 분기하는 토폴로지 필요(KStream선언 후 branch()메소드로 분기처리)
           * #### CPU 지표 중 전체 사용량이 50%가 넘는 경우 필터링 토플로지 필요(KStream객체를 필터링하기 위해서 filter()메소드 필요)
     * #### 기능 구현
       * #### 토픽 생성 > 로컬 메트릭비트 설치 및 설정 > 카프카 스트림즈 개발
     * #### 상용 인프라 이키텍처
       * #### 카프카 클러스터(최소 3대 브로커로 구성) > 스트림즈(APP증가) > 커넥트(분산 모드 커넥트로 구성)
     * #### 미러메이커2를 사용한 토픽 미러링
       * #### 카프카에 저장된 토픽 데이터를 다른 팀이나 다른 회사로 실시간으로 보낼 경우 효과적임
       * #### 미러메이커는 토픽의 파티션 개수 감지, 새로운 토픽 감지, 토픽 설정 변화 감지 기능이 포함되어 있음
       * #### 클러스터의 보안 설정이 되어 있을 경우 권한 획득 설정이 필요
       * #### 미러링 토픽 이름을 정규식으로 선언하여 재시작 없이 토픽이 생성되는 대로 미러링할 수 있다.
       * #### A 카프카 클러스터 > 미러메이커2 > B 카프카 클러스터
         * #### 클러스터 닉네임을 설정해야 함 (clusters = A,B)
         * #### 토픽 방향 설정 (A -> B.topics = weather.seoul)
       * #### 미러메이커2 실행은 bin디렉토리에 connect-mirror-maker.sh사용함
       * #### 분산모드 커넥트를 운영 중이라면 미러메이커2를 구축하지 않아도 된다. 카프카 2.5.0에서는 분산모드 카프카 커넥트를 실행하면 미러링을 위한 커넥터가 준비되어 있으므로 미러메이커2 프로세스를 띄울 필요 없다.
 
  
    
# 고민해볼 것 
* #### 커넥트는 어디서 작성을 하는 것인가?
* #### 오라클 커넥트는 무료로 쓸 수 있는 것이 있는가?
* #### 미러메이커2를 굳이 쓸 필요가 있을까?
* #### 메트릭비트로 구현으로 우리 업무 서버를 관리할 수 있도록 하자
